<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>æ•™å¸«å‡ºé¡Œ Prompt æ¨¡æ¿ï½œAurora v7.3 åˆ—è¡¨å±•é–‹ç‰ˆ</title>
  <style>
    /* --- æ¨£å¼å®Œå…¨ä¿ç•™ï¼Œä¸å‹• --- */
    :root{
      --bg: #0f172a; --text: #f1f5f9; --muted: #94a3b8;
      --brand: #8b5cf6; --brand-glow: rgba(139, 92, 246, 0.5);
      --accent: #2dd4bf; --accent-glow: rgba(45, 212, 191, 0.5);
      --glass-bg: rgba(30, 41, 59, 0.7); --glass-border: rgba(255, 255, 255, 0.08);
      --glass-blur: 20px; --radius: 24px; --shadow-lg: 0 20px 50px -10px rgba(0, 0, 0, 0.5);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; font-family: "PingFang TC", "Noto Sans TC", "Microsoft JhengHei", sans-serif;
      color: var(--text); background-color: var(--bg); min-height: 100vh;
      background-image: radial-gradient(circle at 10% 10%, rgba(139, 92, 246, 0.15), transparent 40%),
                        radial-gradient(circle at 90% 20%, rgba(45, 212, 191, 0.15), transparent 40%);
      background-size: 200% 200%; animation: auroraMove 15s ease infinite alternate;
    }
    @keyframes auroraMove { 0% { background-position: 0% 0%; } 100% { background-position: 100% 100%; } }
    .wrap { max-width: 1280px; margin: 0 auto; padding: 40px 24px 80px; }
    header {
      display: flex; justify-content: space-between; align-items: center; padding: 20px 32px;
      background: var(--glass-bg); backdrop-filter: blur(var(--glass-blur)); border: 1px solid var(--glass-border);
      border-radius: var(--radius); box-shadow: var(--shadow-lg); margin-bottom: 32px;
    }
    .title h1 { margin: 0; font-size: 22px; font-weight: 700; background: linear-gradient(135deg, #fff 0%, #cbd5e1 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .title .sub { font-size: 13px; color: var(--muted); margin-top: 4px; }
    .tag-pill { font-size: 12px; padding: 6px 12px; border-radius: 99px; background: rgba(45, 212, 191, 0.1); border: 1px solid rgba(45, 212, 191, 0.2); color: var(--accent); font-weight: 600; }
    .grid { display: grid; grid-template-columns: 1.1fr 0.9fr; gap: 24px; }
    @media (max-width: 960px) { .grid { grid-template-columns: 1fr; } }
    .card { background: var(--glass-bg); backdrop-filter: blur(var(--glass-blur)); border: 1px solid var(--glass-border); border-radius: var(--radius); box-shadow: var(--shadow-lg); display: flex; flex-direction: column; overflow: hidden; }
    .card .hd { padding: 20px 24px; border-bottom: 1px solid var(--glass-border); display: flex; justify-content: space-between; align-items: center; background: rgba(255, 255, 255, 0.02); }
    .card .bd { padding: 24px; flex: 1; display: flex; flex-direction: column; gap: 20px; }
    label { display: block; font-size: 13px; color: var(--muted); margin-bottom: 8px; font-weight: 500; }
    input, select, textarea { width: 100%; padding: 12px 16px; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 12px; color: var(--text); font-size: 14px; outline: none; transition: 0.2s; }
    textarea { min-height: 520px; font-family: monospace; line-height: 1.7; resize: vertical; }
    .tabs { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 10px; }
    .tab { padding: 8px 16px; border-radius: 99px; background: rgba(255, 255, 255, 0.05); border: 1px solid transparent; font-size: 13px; color: var(--muted); cursor: pointer; transition: all 0.2s; }
    .tab.active { background: rgba(139, 92, 246, 0.15); border-color: rgba(139, 92, 246, 0.3); color: #fff; font-weight: 600; }
    .qblock { background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.08); border-radius: 16px; padding: 20px; margin-bottom: 16px; position: relative; }
    .btns { display: flex; gap: 12px; margin-top: 12px; }
    button { padding: 10px 18px; border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.1); background: rgba(255, 255, 255, 0.05); color: var(--text); font-size: 13px; font-weight: 600; cursor: pointer; transition: 0.2s; }
    button.primary { background: linear-gradient(135deg, var(--brand), #6366f1); border: none; color: #fff; width: 100%; margin-top: 20px; padding: 14px; }
    .toast { position: fixed; left: 50%; bottom: 40px; transform: translateX(-50%); background: #0f172a; border: 1px solid var(--accent); color: var(--accent); padding: 12px 24px; border-radius: 99px; font-size: 14px; display: none; z-index: 1000; }
  </style>
</head>
<body>

<div class="wrap">
  <header>
    <div class="title">
      <h1>æ•™å¸«å‡ºé¡Œ Prompt æ¨¡æ¿ <span style="font-size:0.8em; opacity:0.8; font-weight:400;">Aurora v7.3 Ultimate</span></h1>
      <div class="sub">âœ¨ é›†åˆåè©å¼·åˆ¶å±•é–‹ ï½œ æ•™ç§‘æ›¸ç´šè©³ç›¡åº¦ ï½œ 108èª²ç¶±ç´ é¤Š</div>
    </div>
    <div class="tag-pill">Gemini AI Optimized</div>
  </header>

  <div class="grid">
    <div class="card">
      <div class="hd"><b>âš™ï¸ å…§å®¹è¦åŠƒé¢æ¿</b></div>
      <div class="bd">
        <div class="tabs" id="subjectTabs">
          <div class="tab active" data-subject="åœ‹èª">åœ‹èª</div>
          <div class="tab" data-subject="æ•¸å­¸">æ•¸å­¸</div>
          <div class="tab" data-subject="ç¤¾æœƒ">ç¤¾æœƒ</div>
          <div class="tab" data-subject="è‡ªç„¶">è‡ªç„¶</div>
          <div class="tab" data-subject="è‹±æ–‡">è‹±æ–‡</div>
        </div>

        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:16px;">
          <div><label>å¹´ç´š</label><select id="grade"><option>ä¸‰å¹´ç´š</option><option>å››å¹´ç´š</option><option>äº”å¹´ç´š</option><option selected>å…­å¹´ç´š</option><option>åœ‹ä¸­ä¸ƒå¹´ç´š</option></select></div>
          <div><label>æ•´é«”é›£åº¦</label><select id="difficulty"><option value="ä¸­">æ¨™æº–ä¸­ç­‰</option><option value="æ˜“">ç°¡å–®åŸºç¤</option><option value="é›£">æŒ‘æˆ°é€²éš</option><option value="ç´ é¤Šå°å‘">ç´ é¤Šå°å‘</option></select></div>
        </div>

        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:16px; margin-top:12px;">
           <input id="publisher" placeholder="åƒè€ƒç‰ˆæœ¬ (ä¾‹ï¼šåº·è»’/ç¿°æ—/å—ä¸€)">
           <input id="topic" placeholder="å–®å…ƒå¤§ä¸»é¡Œ (ä¾‹ï¼šé„­æ°æ™‚æœŸ / å¤ªé™½)">
        </div>

        <div style="margin: 20px 0; height: 1px; background: rgba(255,255,255,0.1);"></div>
        <div id="blocks"></div>

        <div class="btns">
          <button id="btnAddQuiz">ï¼‹ æ–°å¢æ¸¬é©—é¡Œçµ„</button>
          <button id="btnAddSum" style="color:var(--accent);">ï¼‹ æ–°å¢é‡é»è¬›ç¾© (å…¨å–®å…ƒ/äººç‰©)</button>
        </div>

        <button class="primary" id="btnGen">âœ¨ ç”Ÿæˆå°ˆå±¬ AI å‘½é¡ŒæŒ‡ä»¤ (å®Œæ•´åˆ—è¡¨ç‰ˆ)</button>
      </div>
    </div>

    <div class="card">
      <div class="hd"><b>ğŸ“ ç”¢å‡ºçš„é«˜è³ªé‡ Prompt</b></div>
      <div class="bd">
        <textarea id="output" placeholder="v7.3 æ›´æ–°èªªæ˜ï¼š&#10;é‡å°ã€Œé‡é»æ•´ç†ã€åŠ å…¥å¼·åˆ¶å±•é–‹æŒ‡ä»¤ã€‚&#10;ç•¶å…§å®¹æåˆ°ã€Œåå¤§å»ºè¨­ã€ã€ã€Œäº”å¤§æ´²ã€ç­‰é›†åˆåè©æ™‚ï¼Œç³»çµ±å°‡å¼·åˆ¶åˆ—å‡ºå®Œæ•´è¡¨æ ¼ï¼Œä¸å†åªå¯«ç¸½ç¨±ï¼"></textarea>
        <button id="btnCopy" style="width:100%; margin-top:12px;">ğŸ“‹ ä¸€éµè¤‡è£½æŒ‡ä»¤</button>
      </div>
    </div>
  </div>
</div>

<div class="toast" id="toast">âœ… å·²è¤‡è£½æŒ‡ä»¤ï¼</div>

<script>
  const $ = (id) => document.getElementById(id);
  let currentSub = "åœ‹èª";

  // --- å°ˆæ¥­é¡Œå‹è¨»å†Šè¡¨ ---
  const commonTypes = ["æ˜¯éé¡Œ", "é¸æ“‡é¡Œ", "å¡«å……é¡Œ", "é–±è®€é¡Œçµ„"];
  
  const subjectRegistry = {
    "åœ‹èª": [...commonTypes, "å­—éŸ³å­—å½¢ (å«æ”¹éŒ¯)", "æˆèªé‹ç”¨", "ä¿®è¾­æŠ€å·§è§£æ", "é‡è¦äººç‰©èªŒ (ä½œè€…/è§’è‰²)", "æ”¹å¯«å¥å­"], 
    "æ•¸å­¸": [...commonTypes, "åŸºç¤é‹ç®—é¡Œ", "æ‡‰ç”¨å•é¡Œ (æ•™æåƒè€ƒ/æ–°ç·¨)", "åœ–è¡¨åˆ¤è®€é¡Œ", "ç°¡ç­”é¡Œ"],
    "ç¤¾æœƒ": [...commonTypes, "é…å°é¡Œ (å²åœ°é€£çµ)", "å¤§äº‹å¹´è¡¨é¡Œ", "é‡è¦äººç‰©èªŒ (æ­·å²äººç‰©)", "åœ°åœ–åˆ¤è®€é¡Œ", "ç°¡ç­”é¡Œ"], 
    "è‡ªç„¶": [...commonTypes, "å¯¦é©—è®Šå› åˆ†æé¡Œ", "æ€§è³ªåˆ†é¡çµ±æ•´è¡¨", "é‡è¦äººç‰©èªŒ (ç§‘å­¸å®¶)", "é…å°é¡Œ (æ€§è³ªæ­¸é¡)"], 
    "è‹±æ–‡": [...commonTypes, "å…‹æ¼å­— (Cloze)", "ä¸­ç¿»è‹±/é€ å¥", "å–®å­—é…å°"]
  };

  // --- é€£å‹•ç›£è½ ---
  document.querySelectorAll(".tab").forEach(t => {
    t.addEventListener("click", () => {
      document.querySelectorAll(".tab").forEach(x => x.classList.remove("active"));
      t.classList.add("active");
      currentSub = t.dataset.subject;
      refreshAllBlocks(); 
    });
  });

  function refreshAllBlocks() {
    document.querySelectorAll('.qblock').forEach(block => {
      const isSum = block.getAttribute("data-is-summary") === "true";
      const select = block.querySelector('.b-type');
      const currentVal = select.value;
      
      let options = getOptionsHtml(isSum);
      select.innerHTML = options;
      
      if ([...select.options].some(o => o.value === currentVal)) {
          select.value = currentVal;
      }

      block.querySelector('.q-sub-name').textContent = currentSub;
      toggleExtraFields(select);
    });
  }

  function getOptionsHtml(isSum) {
    let opts = "";
    if (isSum) {
      opts += `<option value="é‡é»æ•´ç†">å…¨å–®å…ƒé‡é»æ•´ç† (å«åˆ†é¡è¡¨/å¹´è¡¨)</option>`;
      const subTypes = subjectRegistry[currentSub];
      const personType = subTypes.find(t => t.includes("é‡è¦äººç‰©èªŒ"));
      if (personType) {
        opts += `<option value="${personType}">äººç‰©å°ˆé¡Œæ•´ç† (Biography)</option>`;
      }
    } else {
      const types = subjectRegistry[currentSub];
      opts = types.map(t => `<option value="${t}">${t}</option>`).join("");
    }
    return opts;
  }

  function makeBlock(isSum) {
    const div = document.createElement("div");
    div.className = "qblock";
    div.setAttribute("data-is-summary", isSum);
    let options = getOptionsHtml(isSum);

    div.innerHTML = `
      <div style="display:flex; justify-content:space-between; margin-bottom:12px;">
        <b style="font-size:14px;"><span class="q-sub-name">${currentSub}</span> - ${isSum?'è¬›ç¾©é‡é»':'æ¸¬é©—é¡Œçµ„'}</b>
        <button onclick="this.closest('.qblock').remove()" style="color:#f87171; border:none; background:transparent; cursor:pointer;">âœ•</button>
      </div>
      <div style="display:grid; grid-template-columns: 1.2fr 0.8fr; gap:12px;">
        <div><label>å–®å…ƒ/äººç‰©åç¨±</label><input class="b-unit" placeholder="ä¾‹ï¼šé„­æˆåŠŸ / ç‰›é “"></div>
        <div><label>æ¨¡å¼/é¡Œå‹</label><select class="b-type" onchange="toggleExtraFields(this)">${options}</select></div>
      </div>
      <div class="extra-fields" style="display:none; margin-top:12px; grid-template-columns: 1fr 1fr; gap:16px;">
         <div class="field-match" style="display:none;"><label>é¸é …æ± æ•¸é‡</label><input class="b-match-pool" type="number" value="6"></div>
         <div class="field-read" style="display:none;"><label>æ–‡ç« å­—æ•¸</label><input class="b-read-words" type="number" value="450"></div>
      </div>
      <div class="row" style="display:${isSum?'none':'grid'}; grid-template-columns: 1fr 1fr; gap:12px; margin-top:12px;">
        <div><label>æ•¸é‡</label><input class="b-cnt" type="number" value="1"></div>
        <div><label>é›£åº¦</label><select class="b-diff"><option>æ˜“</option><option selected>ä¸­</option><option>é›£</option></select></div>
      </div>
    `;
    $("blocks").appendChild(div);
    toggleExtraFields(div.querySelector('.b-type'));
  }

  function toggleExtraFields(select) {
    const block = select.closest('.qblock');
    const extra = block.querySelector('.extra-fields');
    if(!extra) return;
    const fMatch = block.querySelector('.field-match');
    const fRead = block.querySelector('.field-read');
    extra.style.display = "none"; fMatch.style.display = "none"; fRead.style.display = "none";
    if(select.value.includes("é…å°")) { extra.style.display = "grid"; fMatch.style.display = "block"; }
    if(select.value.includes("é–±è®€") || select.value.includes("å…‹æ¼å­—")) { extra.style.display = "grid"; fRead.style.display = "block"; }
  }

  $("btnAddQuiz").onclick = () => makeBlock(false);
  $("btnAddSum").onclick = () => makeBlock(true);

  // --- æ ¸å¿ƒï¼šç©¶æ¥µå°ˆæ¥­ Prompt ç”Ÿæˆå¼•æ“ (v7.3 åˆ—è¡¨å±•é–‹ç‰ˆ) ---
  $("btnGen").onclick = () => {
    const grade = $("grade").value;
    const diff = $("difficulty").value;
    const pub = $("publisher").value;
    const topic = $("topic").value;

    let p = `# è§’è‰²è¨­å®šï¼šä½ æ˜¯ä¸€ä½æ·±è€•å°ç£æ•™è‚²å¤šå¹´ï¼Œç²¾é€š 108 èª²ç¶±èˆ‡ç´ é¤Šå°å‘å‘½é¡Œçš„ ${currentSub} ç§‘è³‡æ·±åå¸« Auroraã€‚\n`;
    p += `# ä»»å‹™å°è±¡ï¼š${grade} å­¸ç”Ÿ\n# ç¸½é«”ä¸»é¡Œï¼š${topic} (åƒè€ƒç‰ˆæœ¬ï¼š${pub || 'ä¸é™'})\n`;
    
    // --- â˜… v7.0 æ–°å¢ï¼š108èª²ç¶±ç´ é¤Šæœ€é«˜æŒ‡å°åŸå‰‡ ---
    p += `# å‘½é¡Œæœ€é«˜æŒ‡å°åŸå‰‡ï¼šåš´æ ¼éµå®ˆã€Œå°ç£ 108 èª²ç¶±æ ¸å¿ƒç´ é¤Šã€ã€‚æ‰€æœ‰å…§å®¹é ˆå¼·èª¿ã€Œç”Ÿæ´»æƒ…å¢ƒæ‡‰ç”¨ (Contextualizing)ã€èˆ‡ã€Œè·¨é ˜åŸŸé€£çµã€ï¼Œåš´ç¦æ­»èƒŒç¡¬è¨˜ã€‚\n`;
    
    // --- â˜… v7.2 æ–°å¢ï¼šå…§å®¹æš´åŠ›æ“´å……æŒ‡ä»¤ ---
    p += `# å…§å®¹ä»½é‡è¦æ±‚ï¼šå¿…é ˆç”¢å‡ºã€Œæ•™ç§‘æ›¸ç­‰ç´šã€çš„è©³ç›¡å…§å®¹ (Textbook Level Depth)ã€‚\n`;
    p += `# åš´ç¦å·æ‡¶ï¼šè«‹å‹¿åƒ…ä»¥ç²¾ç°¡æ¢åˆ—å¼å¸¶éã€‚æ¯ä¸€å€‹æ ¸å¿ƒæ¦‚å¿µéƒ½å¿…é ˆåŒ…å«ã€Œå®šç¾©ã€ã€ã€ŒåŸç†/èƒŒæ™¯ã€ã€ã€Œç”Ÿæ´»èˆ‰ä¾‹ã€ã€ã€Œå»¶ä¼¸è£œå……ã€å››å€‹å±¤æ¬¡ã€‚\n`;

    // --- â˜… v7.3 æ–°å¢ï¼šé›†åˆåè©å¼·åˆ¶å±•é–‹æŒ‡ä»¤ (æ‚¨è¦çš„åŠŸèƒ½ï¼) ---
    p += `# é›†åˆåè©å±•é–‹åŸå‰‡ï¼šè‹¥å…§å®¹æåŠå…·é«”ç¾¤çµ„ï¼ˆå¦‚ï¼šåå¤§å»ºè¨­ã€äº”å¤§æ´²ã€æ¶ˆåŒ–å™¨å®˜ï¼‰ï¼Œåš´ç¦åªå¯«ç¸½ç¨±ã€‚å¿…é ˆã€Œå®Œæ•´åˆ—å‡ºæ‰€æœ‰ç´°é …ã€ä¸¦å„ªå…ˆè£½ä½œæˆã€ŒMarkdown è¡¨æ ¼ã€ã€‚\n\n`;

    // --- åˆ†ç§‘å°ˆæ¥­æŒ‡ä»¤ (ç¸½é«”è¦æ±‚) ---
    let subPrompt = "";
    if(currentSub === "æ•¸å­¸") {
      subPrompt = `ã€æ•¸å­¸ç§‘å°ˆæ¥­è¦æ±‚ã€‘\n- **ç”Ÿæ´»ç´ é¤Š**ï¼šé¡Œç›®è¨­è¨ˆé ˆçµåˆçœŸå¯¦ç”Ÿæ´»æƒ…å¢ƒï¼ˆå¦‚è³¼ç‰©ã€æ—…éŠã€å»ºç¯‰ï¼‰ï¼Œé¿å…ç´”æ•¸å­—é‹ç®—ã€‚\n- **è©³è§£è¦ç¯„**ï¼šè©³è§£å·å¿…é ˆæä¾›å®Œæ•´çš„ã€ŒStep-by-Step è¨ˆç®—éç¨‹ã€èˆ‡åˆ—å¼ï¼Œä¸¦ç‰¹åˆ¥æ¨™è¨»ã€Œå–®ä½æ›ç®—ã€é™·é˜±ã€‚\n- **æ ¸å¿ƒæ•´ç†**ï¼šåŒ…å«ã€Œè§£é¡Œ S.O.P. æ€è·¯ã€èˆ‡å…¬å¼ç™½è©±è§£é‡‹ã€‚`;
    } else if(currentSub === "è‡ªç„¶") {
      subPrompt = `ã€è‡ªç„¶ç§‘å°ˆæ¥­è¦æ±‚ã€‘\n- **ç”Ÿæ´»é€£çµ**ï¼šå¼·èª¿ç§‘å­¸åŸç†åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­çš„æ‡‰ç”¨èˆ‡å¯¦ä¾‹ï¼ˆå¦‚ï¼šç‚ºä»€éº¼è˜‹æœæœƒè®Šè‰²ï¼Ÿï¼‰ã€‚\n- **åˆ†é¡çµ±æ•´è¡¨æ ¼**ï¼šâ˜…æ ¸å¿ƒâ˜… é‡å°å–®å…ƒæ€§è³ª (å¦‚ï¼šé…¸é¹¼æ€§ã€æ¥è§¸/è¶…è·åŠ›) è£½ä½œã€ŒMarkdown åˆ†é¡å°ç…§è¡¨ã€ã€‚\n- **æ¢ç©¶é‚è¼¯**ï¼šå¯¦é©—é¡Œå¿…é ˆæ¨™è¨»ã€Œæ“ä½œè®Šå› ã€ã€ã€Œæ§åˆ¶è®Šå› ã€èˆ‡ã€Œæ‡‰è®Šè®Šå› ã€ã€‚`;
    } else if(currentSub === "ç¤¾æœƒ") {
      subPrompt = `ã€ç¤¾æœƒç§‘å°ˆæ¥­è¦æ±‚ã€‘\n- **ç”Ÿæ´»å•Ÿç¤º**ï¼šæ­·å²äº‹ä»¶é ˆé€£çµåˆ°ç¾ä»£ç”Ÿæ´»çš„å•Ÿç¤ºæˆ–å¤ä»Šå°ç…§ã€‚\n- **å¤§äº‹å¹´è¡¨**ï¼šæ­·å²å…§å®¹å¿…é ˆç”¢å‡º Markdown è¡¨æ ¼å¹´è¡¨ (æ™‚æœŸï½œäº‹ä»¶ï½œé—œéµå½±éŸ¿)ã€‚\n- **æ•…äº‹åŒ–æ•™å­¸**ï¼šå°‡æ¯ç‡¥çŸ¥è­˜é»èå…¥ç›¸é—œçš„ã€Œæ­·å²å°æ•…äº‹ã€æˆ–ã€Œå‚³èªªè»¼èã€ã€‚\n- **ç©ºé–“è§€å¿µ**ï¼šå¼·åŒ–åœ°åœ–æ–¹ä½ã€åœ°å½¢ç‰¹å¾µèˆ‡åœ°ç†æˆå› çš„è§£æã€‚`;
    } else if(currentSub === "åœ‹èª") {
      subPrompt = `ã€åœ‹èªç§‘å°ˆæ¥­è¦æ±‚ã€‘\n- **æƒ…å¢ƒæ‡‰ç”¨**ï¼šç”Ÿå­—èˆ‡æˆèªæ•™å­¸å¿…é ˆçµåˆã€Œç”Ÿæ´»åŒ–æƒ…å¢ƒé€ å¥ã€ï¼Œæå‡èªæ–‡é‹ç”¨èƒ½åŠ›ã€‚\n- **æ¨™æº–æ³¨éŸ³**ï¼šæ‰€æœ‰ç”Ÿé›£å­—è©å¿…é ˆæ¨™è¨»ã€Œæ•™è‚²éƒ¨æ¨™æº–æ³¨éŸ³ã€ã€‚\n- **ä¿®è¾­è¾¨æ**ï¼šæ˜ç¢ºæŒ‡å‡ºä¸¦è§£æå¥å­æ‰€é‹ç”¨çš„ä¿®è¾­æŠ€å·§ã€‚`;
    } else {
      subPrompt = `ã€è‹±æ–‡ç§‘å°ˆæ¥­è¦æ±‚ã€‘\n- **ç”Ÿæ´»æºé€š**ï¼šå¼·èª¿ Communicative Language Teaching (CLT)ï¼Œå–®å­—èˆ‡å¥å‹éœ€èƒ½åœ¨çœŸå¯¦ç”Ÿæ´»ä¸­ä½¿ç”¨ã€‚\n- **è§£æè¦æ ¼**ï¼šéœ€æä¾›èªæ³•è¦å‰‡è§£èªªã€è©æ€§æ¨™è¨»èˆ‡æ­£ç¢ºç¿»è­¯ã€‚`;
    }

    p += subPrompt + `\n`;
    p += `\nã€è¼¸å‡ºæ’ç‰ˆè¦ç¯„ (å¿…é ˆåš´æ ¼åŸ·è¡Œ)ã€‘\nè«‹å°‡ç”¢å‡ºå…§å®¹æ˜ç¢ºåˆ†ç‚ºå…©ä»½ç¨ç«‹æ–‡ä»¶ï¼š\n1. **[ç¬¬ä¸€ä»½ï¼šå­¸ç”Ÿæ¸¬é©—å·]**ï¼šç´”é¡Œç›®ï¼Œä¸å«ç­”æ¡ˆã€‚æ¯é¡Œå‰æ–¹é ˆåŠ ä¸Š ( ) ä¾›ä½œç­”ã€‚é¡Œèˆ‡é¡Œä¹‹é–“å‹™å¿…ã€Œå¤šç©ºä¸€è¡Œã€ã€‚\n2. **[ç¬¬äºŒä»½ï¼šè€å¸«è©³è§£å·]**ï¼šé¡Œç›®ä¸‹æ–¹ç·Šæ¥ç­”æ¡ˆã€‚å¿…é ˆé™„ä¸Šã€Œç™½è©±è©³è§£ã€èˆ‡ã€Œæ˜“éŒ¯è§£æã€ã€‚\n\n`;

    document.querySelectorAll(".qblock").forEach(b => {
      const unit = b.querySelector(".b-unit").value || "æœªæŒ‡å®š";
      const type = b.querySelector(".b-type").value;
      const isSum = b.getAttribute("data-is-summary") === "true";
      
      // --- äººç‰©èªŒç‰¹æ®ŠæŒ‡ä»¤ ---
      let personInstruct = "";
      if (type.includes("é‡è¦äººç‰©èªŒ")) {
          if (currentSub === "ç¤¾æœƒ") {
              personInstruct = `\n- ã€æ­·å²äººç‰©è¦æ ¼(è©³ç›¡ç‰ˆ)ã€‘ï¼šå§“åã€æ‰€å±¬æœä»£/æ™‚æœŸã€é—œéµäº‹è¹Ÿ(è‡³å°‘3é …è©³è¿°)ã€æ­·å²è©•åƒ¹/å½±éŸ¿ã€ç›¸é—œå‚³èªª/è»¼èã€‚`;
          } else if (currentSub === "è‡ªç„¶") {
              personInstruct = `\n- ã€ç§‘å­¸å®¶è¦æ ¼(è©³ç›¡ç‰ˆ)ã€‘ï¼šå§“åã€é‡è¦ç™¼ç¾/ç™¼æ˜ã€ç§‘å­¸å¯¦é©—éç¨‹ç°¡è¿°ã€å°å¾Œä¸–çš„å½±éŸ¿ã€ç§‘å­¸ç²¾ç¥ã€‚`;
          } else if (currentSub === "åœ‹èª") {
              personInstruct = `\n- ã€ä½œè€…/äººç‰©è¦æ ¼(è©³ç›¡ç‰ˆ)ã€‘ï¼šç”Ÿå¹³ç°¡ä»‹ã€æ–‡å­¸æµæ´¾/å¯«ä½œé¢¨æ ¼ã€ä»£è¡¨ä½œå“è³æã€èª²æ–‡ç›¸é—œèƒŒæ™¯æ•…äº‹ã€‚`;
          }
      }

      if(isSum) {
        if (type.includes("é‡è¦äººç‰©èªŒ")) {
            p += `### ğŸ“š äººç‰©å°ˆé¡Œæ•´ç† (è©³ç›¡ç‰ˆ)ï¼š${unit}\n- å½¢å¼ï¼šçµæ§‹åŒ–äººç‰©è³‡æ–™å¡æˆ–é–±è®€è®€æœ¬ã€‚\n${personInstruct}\n\n`;
        } else {
            // --- â˜… v7.2 ä¿®æ­£ï¼šè¬›ç¾©çµæ§‹ç´°ç¯€è¦æ±‚ (åŠ å…¥ã€Œè©³ç›¡ã€é—œéµå­—) ---
            let sumStruct = "";
            if(currentSub === "ç¤¾æœƒ") {
                // ç¤¾æœƒç§‘ï¼šåŠ å…¥ã€Œå®Œæ•´æ•˜è¿°ã€è¦æ±‚
                sumStruct = `1. **å–®å…ƒå¿ƒæ™ºåœ–æ¶æ§‹** (æ¢åˆ—å¼)\n   2. **æ ¸å¿ƒåè©èˆ‡é—œéµå­—è©³è§£** (è§£é‡‹é ˆè©³ç›¡ï¼Œä¸å¯éç°¡)\n   3. **æ­·å²èƒŒæ™¯èˆ‡æ™‚åºå¼•å°**\n   4. **å¤§äº‹å¹´è¡¨è¡¨æ ¼** (å«å¹´ä»£/äº‹ä»¶/å½±éŸ¿)\n   5. **ğŸ“œ æ­·å²å°æ•…äº‹/å‚³èªªè»¼è** (â˜…éœ€å®Œæ•´æ•˜è¿°èµ·æ‰¿è½‰åˆï¼Œä¸å¯åƒ…ä¸€å¥è©±å¸¶é)\n   6. **æ”¿æ²»/ç¶“æ¿Ÿ/ç¤¾æœƒ/æ–‡åŒ– å››é¢å‘åˆ†æ** (æ·±åº¦åˆ†æ)\n   7. **å¤ä»Šé€£çµèˆ‡ç¾ä»£ç”Ÿæ´»å•Ÿç¤º** (ç”Ÿæ´»ç´ é¤Š)\n   8. **åœ°åœ–èˆ‡ç©ºé–“è§€å¿µè§£æ**`;
            } else if(currentSub === "è‡ªç„¶") {
                // è‡ªç„¶ç§‘ï¼šåŠ å…¥ã€ŒåŸç†è©³è§£ã€è¦æ±‚
                sumStruct = `1. **æ ¸å¿ƒåè©å®šç¾©èˆ‡åŸç†** (éœ€è©³ç´°è§£é‡‹ How & Why)\n   2. **ç”Ÿæ´»ä¸­çš„ç§‘å­¸ç¾è±¡èˆ‡æ‡‰ç”¨å¯¦ä¾‹** (ç”Ÿæ´»ç´ é¤Š)\n   3. **å¯¦é©—è¨­è¨ˆ** (æ¨™è¨»è®Šå› /æ­¥é©Ÿ/å™¨æ)\n   4. **å°ˆå±¬åˆ†é¡å°ç…§è¡¨** (Markdown)\n   5. **è¨˜æ†¶å£è¨£**\n   6. **å»¶ä¼¸ç§‘å­¸çŸ¥è­˜** (è£œå……)`;
            } else if(currentSub === "åœ‹èª") {
                sumStruct = `1. **æœ¬èª²å½¢éŸ³ç¾©è¾¨æ** (æ˜“éŒ¯å­—/å¤šéŸ³å­—)\n   2. **æˆèªå…¸æ•…ã€é‡‹ç¾©èˆ‡ç”Ÿæ´»æ‡‰ç”¨é€ å¥** (éœ€é™„æƒ…å¢ƒ)\n   3. **ä¿®è¾­æŠ€å·§è§£æ** (éœ€é™„åŸå¥åˆ†æ)\n   4. **èª²æ–‡æ–‡æ„æ·±ç©¶èˆ‡ä¸»æ—¨**\n   5. **ä½œè€…ç”Ÿå¹³èˆ‡èƒŒæ™¯**`;
            } else if(currentSub === "æ•¸å­¸") {
                 sumStruct = `1. **å–®å…ƒæ ¸å¿ƒæ¦‚å¿µ**\n   2. **ç”Ÿæ´»ä¸­çš„æ•¸å­¸æ‡‰ç”¨èˆ‰ä¾‹**\n   3. **é‡è¦å…¬å¼èˆ‡åŸç†æ¨å°**\n   4. **è§£é¡Œ S.O.P. æµç¨‹**\n   5. **æ˜“éŒ¯é¡Œå‹èˆ‡è¿·æ€æ¾„æ¸…**`;
            } else {
                sumStruct = `æ ¸å¿ƒæ¦‚å¿µå°è®€ -> ç”Ÿæ´»æƒ…å¢ƒæ‡‰ç”¨ -> é‡é»æ­¸ç´ -> æ˜“æ··æ·†é»è§£æ -> æ‡‰ç”¨ç¯„ä¾‹`;
            }

            p += `### ğŸ“š æ•™å¸«å°ˆç”¨è©³ç›¡å‚™èª²æ‰‹å†Šï¼š${unit}\n- çµæ§‹è¦æ±‚ï¼šè«‹åš´æ ¼ä¾ç…§æ­¤é †åºæ’°å¯«ï¼Œå…§å®¹å¿…é ˆè©³ç›¡å®Œæ•´ï¼Œåš´ç¦å·æ‡¶ã€‚é‡é›†åˆåè©(å¦‚åå¤§å»ºè¨­)é ˆåˆ—è¡¨å±•é–‹ï¼š\n${sumStruct}ã€‚\n\n`;
        }
      } else {
        const cnt = b.querySelector(".b-cnt").value;
        const bDiff = b.querySelector(".b-diff").value;
        let extra = "";
        
        if(type.includes("é…å°")) extra = ` (é¸é …æ± ï¼š${b.querySelector('.b-match-pool').value} å€‹)`;
        if(type.includes("é–±è®€")) extra = ` (æ–‡ç« å­—æ•¸ï¼š${b.querySelector('.b-read-words').value} å­—)`;
        
        // --- â˜… v7.0 ä¿®æ­£ï¼šæ¸¬é©—é¡Œå¼·èª¿ç´ é¤Š ---
        p += `### âœï¸ æ¸¬é©—/è³‡æ–™é¡Œï¼š${unit}\n- é¡Œå‹ï¼š${type}${extra} | æ•¸é‡ï¼š${cnt} | é›£åº¦ï¼š${bDiff}${personInstruct}\n- å‘½é¡Œè¦æ±‚ï¼šè«‹è¨­è¨ˆå…·å‚™ã€Œç´ é¤Šå°å‘ã€çš„é¡Œç›®ï¼Œé¡Œå¹¹é ˆçµåˆç”Ÿæ´»æƒ…å¢ƒï¼Œé¿å…æ­»æ¿èƒŒèª¦ã€‚\n- è©³è§£ï¼šéœ€å«ç™½è©±è§£æèˆ‡æ˜“éŒ¯é»åˆ†æã€‚\n\n`;
      }
    });

    $("output").value = p.trim() + `\n\n--------------------------------------------------\nè«‹ä¾ç…§ä¸Šè¿°è¦ç¯„ï¼Œå…ˆç”¢å‡ºå­¸ç”Ÿå·ï¼Œå†ç”¢å‡ºè€å¸«è©³è§£å·ã€‚`;
  };

  $("btnCopy").onclick = () => {
    $("output").select(); document.execCommand("copy");
    $("toast").style.display = "block"; setTimeout(()=> $("toast").style.display="none", 2000);
  };
</script>
</body>
</html>
